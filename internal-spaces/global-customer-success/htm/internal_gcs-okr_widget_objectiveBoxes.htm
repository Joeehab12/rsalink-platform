<script src='https://code.jquery.com/jquery-3.2.1.js'></script>
<script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js'></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">

<style type="text/css">
/* Style for Collapsible begins here */
.accordion_container {
  width: auto;
  margin: 5px;
  margin-top: 10px;
}
.accordion_head {
    background-color: #ddd;
    color: #333;
    cursor: pointer;
    font-family: arial;
    font-size: 16px;
    margin: 0 0 2px 0;
    padding: 10px 15px;
    font-weight: normal;
    margin-top: 0;
    margin-bottom: 2px;
    border-radius: 4px;
}
.accordion_body {
    background: white;
    padding: 15px;
    border: 1px #dddddd solid;
}
.accordion_body p {
  padding: 18px 5px;
  margin: 0px;
}
/* Style for Collapsible ends here */

.hide{ display: none; }   
.wrapper {
    font-family: Arial;    
    background-color: #fff;
    position: relative;
    width: 99%;
    margin-left: 3px;
    height: auto;
    border: 3px #415464 solid;
    border-radius: 4px;
    margin-top: 10px;
    padding: 5px;
    float: left;
}   
.text{text-align: left; margin: 10px 0px 15px 0px;}
.text a{text-decoration: none;color: #415464; line-height: 1.35em;}
.text a:hover, 
.text a:focus, 
.text a:active {
    color: #415464;
    fill: #415464;
    font-weight: bold;
    text-decoration: underline;
    outline: none;
}
a[data-role=button] {
    font-size: 12px;
    top: 30%;
    text-align: center;
    border-radius: 0px;
    line-height: 25px;
    width: 88%;
    font-weight: bold;
    display: inline-block;
    vertical-align: middle;
    font-family: Arial,sans-serif;
    margin-bottom: 10px;
    position: relative;
    text-transform: none;
    background-color: #802629;
    border: 1px solid #802629;
    color: #fff;
    text-decoration: none;
    transition: background-color .25s ease-out, color .25s ease-out;
}
a[data-role=button]:hover {
    background-color: #fff;
    border: 1px solid #802629;
    color: #802629;
}
label{ margin-right: 15px; }     
.panel {
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, .05);
          box-shadow: 0 1px 2px rgba(0, 0, 0, .05);
}
.panel-heading {
  cursor: pointer;
  cursor: hand;
  background-image: -webkit-linear-gradient(top, #f5f5f5 0%, #e8e8e8 100%);
  background-image:      -o-linear-gradient(top, #f5f5f5 0%, #e8e8e8 100%);
  background-image: -webkit-gradient(linear, left top, left bottom, from(#f5f5f5), to(#e8e8e8));
  background-image:         linear-gradient(to bottom, #f5f5f5 0%, #e8e8e8 100%);
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#fff5f5f5', endColorstr='#ffe8e8e8', GradientType=0);
  background-repeat: repeat-x;
}
#accordionobjective1Url h4 #accordionobjective2Url h4 {
    cursor: pointer;
}
.glyphicon{
    font-size: 12px;
    float: left;
}
.customAccrdnTitle {
    width: 61%;
    display: block;
    float: left;
    margin-left: 4px;
}
.resultsSection .customTrendBox{
    position: relative;
    top: 7px;
}
.resultsSection .customStatusLevelBox{
    bottom: 0px;
}
.resultsSection .customTrendValueBox{
    margin-top: 10px;
}
.customAccrdnHeaderHeight {
    min-height: 55px;
}
.accordionTableData ol{
    padding-left: 20px;
}
.accordionTableData td{
    padding:5px;
    border: 1px solid #C6C6C6;
}
.acc-margin{
    margin: 1px;
}

/* Style for email image icon in the accordion containing document */
.jive-link-email-small {
    background-image: url(https://assets2.jiveon.com/core/2018.13.0.0.7eaeabc/images/jive-icon-email-12x12.png);
    background-repeat: no-repeat;
    background-position: 0px 50%;
    padding: 1px 0 1px 17px;
}

/************* Objective Box Styles Begins Here ************/

* {
    margin: 0;
    padding: 0;
}

.objectivesBox {
    height: 250px;
    font-family: Arial, sans-serif;
    font-size: 14px;
    background-color: #fff;
    border: 2px solid #415464;
    padding: 10px;
}
.objectiveNum {
    font-weight: bold;
    font-size: 18px;
    color: #415464;
}
.objectiveTitle{
    min-height:150px;
    text-align: center;
}
.objectiveTitle p {
font-size: large;
}
.secondRowBox{
    height: 225px;
}
.secondRowBox .objectiveTitle{
    min-height:110px;
}
.boxHover{
    -webkit-transform: perspective(1px) translateZ(0);
    transform: perspective(1px) translateZ(0);
    box-shadow: 3px 3px 3px rgba(65, 84, 100, 0.5);
    position: relative;
    overflow: hidden;
}    
.boxHover:before {
  content: "";
  position: absolute;
  z-index: -1;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  border-color: #415464;
  border-style: solid;
  border-width: 0;
  -webkit-transition-property: border-width;
  transition-property: border-width;
  -webkit-transition-duration: 0.1s;
  transition-duration: 0.3s;
  -webkit-transition-timing-function: ease-out;
  transition-timing-function: ease-out;
}
.boxHover:hover:before, .boxHover:focus:before, .boxHover:active:before {
  -webkit-transform: translateY(0);
  transform: translateY(0);
  border-width: 4px;
}
.tableWrapper {
    width: 100%;
    display: flex;
    justify-content: center;
    float: left;
    margin-bottom: 30px;
    margin-top: 20px;
}
.objective {
    width: 33%;
    float: left;
    margin: 0 20px;
    cursor: pointer;
}
.objectiveFooter {
    width: 100%;
    height: 76px;
    margin-top: -5px;
}    
.boxHighlight{
    border: 3px solid #415464;
}
.shrinkBox {
    transition:all 0.3s ease;
    cursor: pointer;
    -webkit-transform: scale(0.8);
    -ms-transform: scale(0.8);
    transform: scale(0.8);
}
.overallCompletedField{
    font-size: 16px;
    font-weight: bold;
    text-align: center;
}
.objectiveStatus{
    text-align: center;
    width: 55%;
    padding: 10px;
    color: #fff;
    margin-top: 0px;
    font-weight: bold;
    font-size: 18px;
    float: left;
}
.overallTrendContainer{
    float: left;
    width: 26%;
    margin-left: 50px;
    margin-top: 5px;
}
.overallTrendContainer .overallTrend{
    height: 40px;
    width: 40px;
    display: block;
    float: left;
}
.overallTrendValue{
    font-size: 20px;
    font-weight: bold;
    margin-left: 5px;
    margin-top: 13px;
    display: block;
    float: left;
}
.bottomRowFields{
    margin-top: 0px;
}
.bottomRowFieldslastTwo {
    margin-bottom: 0px;
    margin-top: 27px;
}

/************* Objective Box Styles Ends Here ************/
    
/************* Key Results Styles Begins Here *************/
.corporateGoalContainer{
    clear: both;
    width: 100%;
}
.okrContainer {
    clear: both;
    width: 100%;
}
.okrContainerText {
    font: 18px Arial;
}
.leadValueContainer{
    clear: both;
    width: 100%;
}
.workingTeamContainer{
    clear: both;
    width: 100%;
}
/* Hide the email icon in the Key Results boxes */
.jive-link-email-small {
    background-image: none;
    padding: 1px 0 1px 0px;
}
.resultsSection{float: right;height: 20px; width: 17%;}
.Yellow{background-color: #FFC90E;}
.Green{background-color:#22B14C;}
.Red {background-color:#ED1C24;}
.Up {
    background-image:url('https://community.rsa.com/resources/statics/238998/green-up-arrow.png-128px.png?a=1558329986554');
    background-repeat: no-repeat;
    height: 20px;
    width: 20px;
    background-size: 100%;
}

.Down {
    background-image:url('https://community.rsa.com/resources/statics/238998/red-down-arrow-128px.png?a=1558330944180');
    background-repeat: no-repeat;
    height: 20px;
    width: 20px;
    background-size: 100%;
}

.Neutral{
    background-image:url('https://community.rsa.com/resources/statics/238998/neutral.png?a=1558450398552');
    background-repeat: no-repeat;
    height: 20px;
    width: 20px;
    background-size: 100%;
}
.resultStatusLevel{
    display: block;
    width: 45%;
    padding: 10px;
    height: 35px;
    position: relative;
    bottom: 9px;
    text-align: center;
    float: left;
    color: #fff;
    font-weight: bold;
}
.trendBox{
    display: block;
    float: left;
    margin-left: 30px;
    min-width: 8%;
    min-height: 10px;
}
.trendValueBox{
    margin-left: 10px;
    display: block;
    float: left;
    margin-top: 3px;
    font-weight: bold;
}
.actionCompletedImage{
    background-image:url('https://community.rsa.com/resources/statics/238998/action-completed.png?a=1558344666556');
    background-repeat: no-repeat;
    height: 20px;
    width: 20px;
    background-size: 100%;
    display: block;
    float: left;
    margin-right: 3px;  
    margin-top: -2px;
}
.customWidth21{
    width: 21% !important;
}
.objective1,.objective2,.objective3,.objective4,.objective5,.objective6{display: none;}
#back-on-top i {
    color: #fff;
    margin: 0;
    position: relative;
    top: 13px;
    font-size: 19px;
    -webkit-transition: all 0.3s ease;
    -moz-transition: all 0.3s ease;
    -ms-transition: all 0.3s ease;
    -o-transition: all 0.3s ease;
    transition: all 0.3s ease;
    background-color: #415464;
    border-radius: 20px;
    padding: 10px;
    float: right;
    text-decoration: none;
}
#back-on-top:hover {
    background-color: #415464;
}
#back-on-top:hover i {
    color: #fff;
}
.disableToTheTop {
    display: none;
}
/************* Key Results Styles Ends Here *************/
</style>

<script>
var $j = jQuery.noConflict();

/*********** Objective Box Script **********/
$j(document).ready(function() {
    $j('.objective').each(function(){
        $j(this).click(function(){
            resizeWidget();
            var keyResultId = $j(this).attr('id');
            var boxClass = $j(this).attr('id');
            //$j('.keyResultsContainer').hide();
            if($j('.'+boxClass).is(':visible')){
                $j('.keyResultsContainer .'+boxClass).hide();
                $j('.disableToTheTop').css("display", "none");
            }else{                  
                $j('.keyResultsContainer .wrapper').hide();
                $j('.keyResultsContainer .'+boxClass).show();
                $j('.disableToTheTop').css("display", "block");
            }
            $j('.objectivesBox').addClass('boxHover');
            if($j(this).hasClass('boxHighlight')){
                $j('.objective').removeClass('boxHighlight').removeClass('shrinkBox');
                $j('.objectivesBox').addClass('boxHover');
            }else{
                $j(this).find('.objectivesBox').removeClass('boxHover');
                $j('.objective').addClass('shrinkBox').removeClass('boxHighlight');
                $j(this).removeClass('shrinkBox');
                $j(this).addClass('boxHighlight');
                $j('html,body', window.parent.document).animate({ scrollTop: "1200px" }, 1000);
            }
        });
    }); 
});

/*********** Key Results Accordion Script **********/

function resizeWidget() {
    setTimeout( resizeMe, 500);
    
}
//Enables console.log messages in Firefox 
function log(msg){
    if (typeof console === "undefined" || typeof console.log === "undefined") return false;
    console.log(msg);
}

// Loads in the setup document and parses the table information into the accordion.
function init(){
    if(!sourceURL) {
        log("No setup document given");
        return false;
    }
    // Load the setup document
    var sourceUrlList = {
                          "urlList": {
                            "objective1Url":"https://community.rsa.com/docs/DOC-104746",
                            "objective2Url": "https://community.rsa.com/docs/DOC-104266",
                            "objective3Url": "https://community.rsa.com/docs/DOC-104882",
                            "objective4Url": "https://community.rsa.com/docs/DOC-104883",
                            "objective5Url": "https://community.rsa.com/docs/DOC-104884",
                            "objective6Url": "https://community.rsa.com/docs/DOC-104885"                                
                          }
                        };

    $j.each( sourceUrlList.urlList, function( key, value ) {
            $j.ajax({
            type: 'GET',
            url: value,
            dataType: 'html',
            success: function (data) { 
                
                // Point to the table in the setup document
                var product = $j('.actionsTitle', data);
                if(product.length < 1) {
                    alert('No table found in the setup document.  Please make sure the setup document is correctly formatted.');
                    return false;
                }
                // Check to make sure there are at least two table rows
                var rows = $j('.actionsTitle', data);
                if(rows.length < 1) {
                    alert('The table does not have at least 1 row.  Please properly create the table in the setup document.');
                    return false;
                }

                //Getting StatusLevel, Status Value, Trend, Trend Value Data
                // set variables for temporarily storing table data
                var tmpHTML = '';
                var collapseIncrementer = 1;
                // Loop over the remaining rows and place them in the accordion.
                var totalRowCount = 0;
                for (var i = 0; i < rows.length; i++) {
                    //Grabs the content in the table row.
                    var statusLevel, statusValue, trend, trendValue;
                    $j.each($j('.keyResultTable .keyResultRow', data), function( key, value ) {
                        if($j.trim($j(rows[i]).text()) == $j.trim($j(value).find(".keyResult").text())){
                            statusLevel = $j(value).find(".statusLevel").text();
                            statusValue = $j(value).find(".statusValue").text();
                            trend = $j(value).find(".trend").text();
                            trendValue = $j(value).find(".trendValue").text();
                        }
                    })  
                
                    totalRowCount += parseInt($j("table:first", $j(rows[i]).next()).find("tr").length - 1);
                    $j('table:first', $j(rows[i]).next()).addClass("accordionTableData");
                    titleHtml = $j(rows[i]).text();
                    
                    //Fetches Trend from ObjectiveIntroTable and displays in respective objectives
                    var overallObjectiveStatusLevel,overallTrend,overallTrendNumValue,overallObjectiveStatus,totalKeyResults,completedKeyResults;
                    $j.each($j('.objectiveIntroTable', data), function( key, value ){
                         overallObjectiveStatus = $j(value).find('.overallStatus', data).text();
                    });
                    $j.each($j('.objectiveIntroTable', data), function( key, value ){
                         overallObjectiveStatusLevel = $j(value).find('.overallStatusLevel', data).text();
                    });
                    $j.each($j('.objectiveIntroTable', data), function( key, value ){
                         overallTrend = $j(value).find('.overallTrendValue', data).text();
                    });
                    $j.each($j('.objectiveIntroTable', data), function( key, value ){
                         overallTrendNumValue = $j(value).find('.overallTrendNumValue', data).text();
                    });
                    $j.each($j('.objectiveIntroTable', data), function( key, value ){
                         totalKeyResults = $j(value).find('.totalKeyResultsValue', data).text();
                    });
                    $j.each($j('.objectiveIntroTable', data), function( key, value ){
                         completedKeyResults = $j(value).find('.completedKeyResultsValue', data).text();
                    });

                    $j('table:first', $j(rows[i]).next()).css('width',"100%");
                    $j.each($j('table:first tr', $j(rows[i]).next()), function( key, value ) {
                        //actionCompletedDate
                        $j(value).find(".completedDateCol").css("display","none");
                        $j(value).find(".actionCompletedDate").css("display","none");
                        if($j(value).find(".actionCompleted").text() == 'Yes'){
                            $j(value).find(".actionCompleted").addClass('customWidth21');
                            $j(value).find(".actionCompleted").html("<span class='actionCompletedImage'></span><span class=''>Completed on </span>"+$j(value).find('.actionCompletedDate').text()+"</label></li></ul>");
                        }else{
                            $j(value).find(".actionCompleted").removeClass('customWidth21');
                        }
                    });
                    
                    bodyHtml = $j('table:first', $j(rows[i]).next()).parent().html();

                    tmpHTML += "<div class='panel " + colorStyle + "'> <h4 class='panel-heading panel-title' data-toggle='collapse' data-parent='#accordion"+key+"' data-parent='#accordionObj1' href='#collapse"+key+ collapseIncrementer + "' onclick='resizeWidget()' style:''> <span class='glyphicon glyphicon-plus'></span> &nbsp;<span class='accrdnTitle'>" + titleHtml + "</span><div class='resultsSection'><span class='resultStatusLevel "+statusLevel+"'>"+statusValue+"</span><span class='trendBox "+trend+"'></span><span class='trendValueBox'>"+trendValue+"</span></div></h4> <div id='collapse" +key+ collapseIncrementer + "' class='panel-collapse collapse";
                    if (typeof initState !== 'undefined') {
                        if ( initState == 'Expanded' || ( i == 0 && ( initState == 'First' || initState == 'undefined' ) ) ) {
                            tmpHTML += " in";
                        }
                    } else if ( i == 0 ) {
                        tmpHTML += " in";
                    }
                    tmpHTML += " panel-body'> " + bodyHtml +"</div> </div>";
                    collapseIncrementer++;                      
                } // end for loop
                
                // Append the loop HTML to the resultArea

                if(key == "objective1Url"){                           
                        $j('.objective1 .testimonial #accordionobjective1Url').html(tmpHTML);    
                        $j('.objective1 .testimonial #totalActiveProjects').text('Total Number of Active RSA Link Team Projects: '+ totalRowCount);                   
                        $j('.objective1 .testimonial #corporateGoalValueObj1').text($j('.objectiveIntroTable', data).find(".corporateGoalValue").text());
                        $j('.objective1 .testimonial #leadValueObj1').html($j('.objectiveIntroTable', data).find(".leadValue").html());    
                        $j('.objective1 .testimonial #workingTeamValueObj1').html($j('.objectiveIntroTable', data).find(".workingTeamValue").html());    
                        
                        //Removes lightbox effect from images and links that are served by the jive servlet.  Passes through non-jive servlet links.
                        $j('.objective1 .testimonial #accordionObj1').find('img').attr('onclick','if ($j(this).parent().prop("nodeName")=="A" && $j(this).parent().attr("href").indexOf("JiveServlet") >= 0){return false;}');
                        $j('.objective1 .testimonial #accordionObj1').find('a').attr('target','_blank');
                        $j('#objective1 .overallTrendValue').html(overallTrendNumValue);
                        $j('#objective1 .overallTrend').addClass(overallTrend);
                        $j('#objective1 .objectiveStatus').addClass(overallObjectiveStatusLevel);
                        $j('#objective1 .objectiveStatus').html(overallObjectiveStatus);
                        $j('#objective1 .overallCompletedField').html(completedKeyResults + " of " + totalKeyResults + " Completed");
                } else if(key == "objective2Url"){
                        $j('.objective2 .testimonial #accordionobjective2Url').html(tmpHTML);    
                        $j('.objective2 .testimonial #totalActiveProjects').text('Total Number of Active RSA Link Team Projects: '+ totalRowCount);                   
                        $j('.objective2 .testimonial #corporateGoalValueObj2').text($j('.objectiveIntroTable', data).find(".corporateGoalValue").text());
                        $j('.objective2 .testimonial #leadValueObj2').html($j('.objectiveIntroTable', data).find(".leadValue").html());    
                        $j('.objective2 .testimonial #workingTeamValueObj2').html($j('.objectiveIntroTable', data).find(".workingTeamValue").html());    
                        
                        //Removes lightbox effect from images and links that are served by the jive servlet.  Passes through non-jive servlet links.
                        $j('.objective2 .testimonial #accordionObj2').find('img').attr('onclick','if ($j(this).parent().prop("nodeName")=="A" && $j(this).parent().attr("href").indexOf("JiveServlet") >= 0){return false;}');
                        $j('.objective2 .testimonial #accordionObj2').find('a').attr('target','_blank');
                        $j('#objective2 .overallTrendValue').html(overallTrendNumValue);
                        $j('#objective2 .overallTrend').addClass(overallTrend);
                        $j('#objective2 .objectiveStatus').addClass(overallObjectiveStatusLevel);
                        $j('#objective2 .objectiveStatus').html(overallObjectiveStatus);
                        $j('#objective2 .overallCompletedField').html(completedKeyResults + " of " + totalKeyResults + " Completed");
                } else if(key == "objective3Url"){
                        $j('.objective3 .testimonial #accordionobjective3Url').html(tmpHTML);    
                        $j('.objective3 .testimonial #totalActiveProjects').text('Total Number of Active RSA Link Team Projects: '+ totalRowCount);                   
                        $j('.objective3 .testimonial #corporateGoalValueObj3').text($j('.objectiveIntroTable', data).find(".corporateGoalValue").text());
                        $j('.objective3 .testimonial #leadValueObj3').html($j('.objectiveIntroTable', data).find(".leadValue").html());    
                        $j('.objective3 .testimonial #workingTeamValueObj3').html($j('.objectiveIntroTable', data).find(".workingTeamValue").html());    
                        
                        //Removes lightbox effect from images and links that are served by the jive servlet.  Passes through non-jive servlet links.
                        $j('.objective3 .testimonial #accordionObj3').find('img').attr('onclick','if ($j(this).parent().prop("nodeName")=="A" && $j(this).parent().attr("href").indexOf("JiveServlet") >= 0){return false;}');
                        $j('.objective3 .testimonial #accordionObj3').find('a').attr('target','_blank');
                        $j('#objective3 .overallTrendValue').html(overallTrendNumValue);
                        $j('#objective3 .overallTrend').addClass(overallTrend);
                        $j('#objective3 .objectiveStatus').addClass(overallObjectiveStatusLevel);
                        $j('#objective3 .objectiveStatus').html(overallObjectiveStatus);
                        $j('#objective3 .overallCompletedField').html(completedKeyResults + " of " + totalKeyResults + " Completed");
                } else if(key == "objective4Url"){
                        $j('.objective4 .testimonial #accordionobjective4Url').html(tmpHTML);    
                        $j('.objective4 .testimonial #totalActiveProjects').text('Total Number of Active RSA Link Team Projects: '+ totalRowCount);                   
                        $j('.objective4 .testimonial #corporateGoalValueObj4').text($j('.objectiveIntroTable', data).find(".corporateGoalValue").text());
                        $j('.objective4 .testimonial #leadValueObj4').html($j('.objectiveIntroTable', data).find(".leadValue").html());    
                        $j('.objective4 .testimonial #workingTeamValueObj4').html($j('.objectiveIntroTable', data).find(".workingTeamValue").html());    
                        
                        //Removes lightbox effect from images and links that are served by the jive servlet.  Passes through non-jive servlet links.
                        $j('.objective4 .testimonial #accordionObj4').find('img').attr('onclick','if ($j(this).parent().prop("nodeName")=="A" && $j(this).parent().attr("href").indexOf("JiveServlet") >= 0){return false;}');
                        $j('.objective4 .testimonial #accordionObj4').find('a').attr('target','_blank');
                        $j('#objective4 .overallTrendValue').html(overallTrendNumValue);
                        $j('#objective4 .overallTrend').addClass(overallTrend);
                        $j('#objective4 .objectiveStatus').addClass(overallObjectiveStatusLevel);
                        $j('#objective4 .objectiveStatus').html(overallObjectiveStatus);
                        $j('#objective4 .overallCompletedField').html(completedKeyResults + " of " + totalKeyResults + " Completed");
                } else if(key == "objective5Url"){
                        $j('.objective5 .testimonial #accordionobjective5Url').html(tmpHTML);    
                        $j('.objective5 .testimonial #totalActiveProjects').text('Total Number of Active RSA Link Team Projects: '+ totalRowCount);                   
                        $j('.objective5 .testimonial #corporateGoalValueObj5').text($j('.objectiveIntroTable', data).find(".corporateGoalValue").text());
                        $j('.objective5 .testimonial #leadValueObj5').html($j('.objectiveIntroTable', data).find(".leadValue").html());    
                        $j('.objective5 .testimonial #workingTeamValueObj5').html($j('.objectiveIntroTable', data).find(".workingTeamValue").html());    
                        
                        //Removes lightbox effect from images and links that are served by the jive servlet.  Passes through non-jive servlet links.
                        $j('.objective5 .testimonial #accordionObj5').find('img').attr('onclick','if ($j(this).parent().prop("nodeName")=="A" && $j(this).parent().attr("href").indexOf("JiveServlet") >= 0){return false;}');
                        $j('.objective5 .testimonial #accordionObj5').find('a').attr('target','_blank');
                        $j('#objective5 .overallTrendValue').html(overallTrendNumValue);
                        $j('#objective5 .overallTrend').addClass(overallTrend);
                        $j('#objective5 .objectiveStatus').addClass(overallObjectiveStatusLevel);
                        $j('#objective5 .objectiveStatus').html(overallObjectiveStatus);
                        $j('#objective5 .overallCompletedField').html(completedKeyResults + " of " + totalKeyResults + " Completed");
                } else if(key == "objective6Url"){
                        $j('.objective6 .testimonial #accordionobjective6Url').html(tmpHTML);    
                        $j('.objective6 .testimonial #totalActiveProjects').text('Total Number of Active RSA Link Team Projects: '+ totalRowCount);                   
                        $j('.objective6 .testimonial #corporateGoalValueObj6').text($j('.objectiveIntroTable', data).find(".corporateGoalValue").text());
                        $j('.objective6 .testimonial #leadValueObj6').html($j('.objectiveIntroTable', data).find(".leadValue").html());    
                        $j('.objective6 .testimonial #workingTeamValueObj6').html($j('.objectiveIntroTable', data).find(".workingTeamValue").html());    
                        
                        //Removes lightbox effect from images and links that are served by the jive servlet.  Passes through non-jive servlet links.
                        $j('.objective6 .testimonial #accordionObj6').find('img').attr('onclick','if ($j(this).parent().prop("nodeName")=="A" && $j(this).parent().attr("href").indexOf("JiveServlet") >= 0){return false;}');
                        $j('.objective6 .testimonial #accordionObj6').find('a').attr('target','_blank');
                        $j('#objective6 .overallTrendValue').html(overallTrendNumValue);
                        $j('#objective6 .overallTrend').addClass(overallTrend);
                        $j('#objective6 .objectiveStatus').addClass(overallObjectiveStatusLevel);
                        $j('#objective6 .objectiveStatus').html(overallObjectiveStatus);
                        $j('#objective6 .overallCompletedField').html(completedKeyResults + " of " + totalKeyResults + " Completed");
                }
                
                $j(".collapse.in").each(function(){
                    $j(this).siblings(".panel-heading").find(".glyphicon").addClass("glyphicon-minus").removeClass("glyphicon-plus");
                });
               $j('.panel-title').each(function(){
                    if($j(this).attr('href') === '#collapseobjective1Url2' || $j(this).attr('href') === '#collapseobjective3Url1' || $j(this).attr('href') === '#collapseobjective5Url2'){
                        $j(this).find('.accrdnTitle').addClass('customAccrdnTitle');
                        $j(this).find('.resultStatusLevel').addClass('customStatusLevelBox');
                        $j(this).find('.trendBox').addClass('customTrendBox');
                        $j(this).find('.trendValueBox').addClass('customTrendValueBox');
                        $j(this).addClass('customAccrdnHeaderHeight');
                    }
                });
        
                // Toggle plus minus icon on show hide of collapse element
                $j(".collapse").on('show.bs.collapse', function(){
                    $j(this).parent().find(".glyphicon").removeClass("glyphicon-plus").addClass("glyphicon-minus");
                }).on('hide.bs.collapse', function(){
                    $j(this).parent().find(".glyphicon").removeClass("glyphicon-minus").addClass("glyphicon-plus");
                });      
                resizeWidget();
                resizeMe();                        
            },
            error: function (xhr, ajaxOptions, thrownError){ 
                alert("There was an error: Most likely reason is your sourceURL variable is not pointing to a valid document");
                return false;
            },
            complete: function(){
                resizeWidget();
            }
        });
    });
  
} 
// Color Styles
// "panel-default" = Silver
// "panel-primary" = Blue
// "panel-info" = Sky Blue
// "panel-success" = Green
// "panel-warning" = Orange
// "panel-danger" = Red

var colorStyle='panel-default';
var sourceURL='https://community.rsa.com/docs/DOC-103296';
//var sourceURL='https://rsa-preview.jiveon.com/docs/DOC-142338';

//var sourceURL='https://community.rsa.com/docs/DOC-93468';
//var sourceURL='https://rsa-preview.jiveon.com/docs/DOC-142311';

// First panel expanded = "First"
// All panels collapsed = "Collapsed"
// All panels expanded = "Expanded"
var initState='Collapsed';
init();
  
function resizeWidget() {
    setTimeout( resizeMe, 500);
}
</script>   
<!--<div class="okrMainTitle">
    <h2>Objectives and Key Results</h2>
</div>-->
<div class="tableWrapper">
    <div class="objective" id="objective1">
        <div class="objectivesBox boxHover">
            <div class="objectiveTitle">
                <p><span class="objectiveNum">OBJECTIVE 1:</span></br>70% of field facing team members strongly or fully agreeing with the statement “Providing best in class customer experience is a top priority at RSA” in the VoC-E</p>
            </div>
            <div class="objectiveFooter objectiveDetails">
                <div class="overallCompletedField"></div>
                <div class="objectiveStatus"></div>
                <div class="overallTrendContainer">
                    <span class="overallTrend"></span>
                    <span class="overallTrendValue"></span>
                </div>
            </div>
        </div>
    </div>
    <div class="objective" id="objective2">
        <div class="objectivesBox boxHover">
            <div class="objectiveTitle">
                <p><span class="objectiveNum">OBJECTIVE 2:</span></br>Improve customer experience with RSA to achieve cNPS of FY20 goal of +25</p>
            </div>
            <div class="objectiveFooter objectiveDetails">
                <div class="overallCompletedField"></div>
                <div class="objectiveStatus"></div>
                <div class="overallTrendContainer">
                    <span class="overallTrend"></span>
                    <span class="overallTrendValue"></span>
                </div>
            </div>
        </div>
    </div>
    <div class="objective" id="objective3">
        <div class="objectivesBox boxHover">
            <div class="objectiveTitle">
                <p><span class="objectiveNum">OBJECTIVE 3:</span></br>Improve quality, governance and access to Customer Master Data</p>
            </div>
            <div class="objectiveFooter objectiveDetails">
                <div class="overallCompletedField"></div>
                <div class="objectiveStatus"></div>
                <div class="overallTrendContainer">
                    <span class="overallTrend"></span>
                    <span class="overallTrendValue"></span>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="tableWrapper">
    <div class="objective" id="objective4">
        <div class="objectivesBox boxHover secondRowBox">
            <div class="objectiveTitle">
                <p><span class="objectiveNum">OBJECTIVE 4:</span></br>Implement programs to improve the product Net Promoter Score (pNPS) for the RSA Fraud & Risk Intelligence Suite</p>
            </div>
            <div class="objectiveFooter objectiveDetails">
                <div class="overallCompletedField bottomRowFields"></div>
                <div class="objectiveStatus"></div>
                <div class="overallTrendContainer">
                    <span class="overallTrend"></span>
                    <span class="overallTrendValue"></span>
                </div>
            </div>
        </div>
    </div>
    <div class="objective" id="objective5">
        <div class="objectivesBox boxHover secondRowBox">
            <div class="objectiveTitle">
                <p><span class="objectiveNum">OBJECTIVE 5:</span></br>Implement programs to improve the product Net Promoter Score (pNPS) for RSA SecurID Access</p>
            </div>
            <div class="objectiveFooter objectiveDetails">
                <div class="overallCompletedField bottomRowFieldslastTwo"></div>
                <div class="objectiveStatus"></div>
                <div class="overallTrendContainer">
                    <span class="overallTrend"></span>
                    <span class="overallTrendValue"></span>
                </div>
            </div>
        </div>
    </div>
    <div class="objective" id="objective6">
        <div class="objectivesBox boxHover secondRowBox">
            <div class="objectiveTitle">
                <p><span class="objectiveNum">OBJECTIVE 6:</span></br>Launch 4 Solutions/Risk Frameworks & enable sales to drive in strategic accounts</p>
            </div>
            <div class="objectiveFooter objectiveDetails">
                <div class="overallCompletedField bottomRowFieldslastTwo"></div>
                <div class="objectiveStatus"></div>
                <div class="overallTrendContainer">
                    <span class="overallTrend"></span>
                    <span class="overallTrendValue"></span>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="keyResultsContainer" id="keyResultsContainer">
     <div class="wrapper objective1">
        <div class="testimonial">
            <div class="name"></div>         
            <div class="corporateGoalContainer">
                <h4><b>Corporate Goal: </b><span id="corporateGoalValueObj1"></span></h4>
            </div>
            <div class="okrContainer">
                <h4><b>Objective and Key Results: </b><span class="okrContainerText">FY20 goal of 70% of field facing team members strongly or fully agreeing with the statement “Providing best in class customer experience is a top priority at RSA” in the VoC-E</span></h4>
            </div>
            <div class="leadValueContainer">
                <h4><b>Executive Sponsor: </b><span id="leadValueObj1"></span></h4>
            </div>
            <div class="workingTeamContainer">
                <h4><b>Leadership Team: </b><span id="workingTeamValueObj1"></span></h4>
            </div>
            <div id="keyResultTableObj1"></div>
            <div id='AccordionContainerObj1' class='acc-margin'>
                <div class='panel-group' id='accordionobjective1Url'>
                </div>
            </div>
        </div>
    </div>
    <div class="wrapper objective2">
        <div class="testimonial">
            <div class="name"></div>         
            <div class="corporateGoalContainer">
                <h4><b>Corporate Goal: </b><span id="corporateGoalValueObj2"></span></h4>
            </div>
            <div class="okrContainer">
                <h4><b>Objective and Key Results: </b><span class="okrContainerText">Improve customer experience with RSA to achieve cNPS of FY20 goal of +25</span></h4>
            </div>
            <div class="leadValueContainer">
                <h4><b>Executive Sponsor: </b><span id="leadValueObj2"></span></h4>
            </div>
            <div class="workingTeamContainer">
                <h4><b>Leadership Team: </b><span id="workingTeamValueObj2"></span></h4>
            </div>
            <div id="keyResultTableObj2"></div>
            <div id='AccordionContainerObj2' class='acc-margin'>
                <div class='panel-group' id='accordionobjective2Url'>
                </div>
            </div>
        </div>
    </div>
    <div class="wrapper objective3">
        <div class="testimonial">
            <div class="name"></div>         
            <div class="corporateGoalContainer">
                <h4><b>Corporate Goal: </b><span id="corporateGoalValueObj3"></span></h4>
            </div>
            <div class="okrContainer">
                <h4><b>Objective and Key Results: </b><span class="okrContainerText">Improve quality, governance and access to Customer Master Data</span></h4>
            </div>
            <div class="leadValueContainer">
                <h4><b>Executive Sponsor: </b><span id="leadValueObj3"></span></h4>
            </div>
            <div class="workingTeamContainer">
                <h4><b>Leadership Team: </b><span id="workingTeamValueObj3"></span></h4>
            </div>
            <div id="keyResultTableObj3"></div>
            <div id='AccordionContainerObj3' class='acc-margin'>
                <div class='panel-group' id='accordionobjective3Url'>
                </div>
            </div>
        </div>
    </div>
    <div class="wrapper objective4">
        <div class="testimonial">
            <div class="name"></div>         
            <div class="corporateGoalContainer">
                <h4><b>Corporate Goal: </b><span id="corporateGoalValueObj4"></span></h4>
            </div>
            <div class="okrContainer">
                <h4><b>Objective and Key Results: </b><span class="okrContainerText">Implement programs to improve the product Net Promoter Score (pNPS) for the RSA Fraud & Risk Intelligence Suite</span></h4>
            </div>
            <div class="leadValueContainer">
                <h4><b>Executive Sponsor: </b><span id="leadValueObj4"></span></h4>
            </div>
            <div class="workingTeamContainer">
                <h4><b>Leadership Team: </b><span id="workingTeamValueObj4"></span></h4>
            </div>
            <div id="keyResultTableObj4"></div>
            <div id='AccordionContainerObj4' class='acc-margin'>
                <div class='panel-group' id='accordionobjective4Url'>
                </div>
            </div>
        </div>
    </div>
    <div class="wrapper objective5">
        <div class="testimonial">
            <div class="name"></div>         
            <div class="corporateGoalContainer">
                <h4><b>Corporate Goal: </b><span id="corporateGoalValueObj5"></span></h4>
            </div>
            <div class="okrContainer">
                <h4><b>Objective and Key Results: </b><span class="okrContainerText">Implement programs to improve the product Net Promoter Score (pNPS) for RSA SecurID Access</span></h4>
            </div>
            <div class="leadValueContainer">
                <h4><b>Executive Sponsor: </b><span id="leadValueObj5"></span></h4>
            </div>
            <div class="workingTeamContainer">
                <h4><b>Leadership Team: </b><span id="workingTeamValueObj5"></span></h4>
            </div>
            <div id="keyResultTableObj5"></div>
            <div id='AccordionContainerObj5' class='acc-margin'>
                <div class='panel-group' id='accordionobjective5Url'>
                </div>
            </div>
        </div>
    </div>
    <div class="wrapper objective6">
        <div class="testimonial">
            <div class="name"></div>         
            <div class="corporateGoalContainer">
                <h4><b>Corporate Goal: </b><span id="corporateGoalValueObj6"></span></h4>
            </div>
            <div class="okrContainer">
                <h4><b>Objective and Key Results: </b><span class="okrContainerText">Launch 4 Solutions/Risk Frameworks & enable sales to drive in strategic accounts</h4>
            </div>
            <div class="leadValueContainer">
                <h4><b>Executive Sponsor: </b><span id="leadValueObj6"></span></h4>
            </div>
            <div class="workingTeamContainer">
                <h4><b>Leadership Team: </b><span id="workingTeamValueObj6"></span></h4>
            </div>
            <div id="keyResultTableObj6"></div>
            <div id='AccordionContainerObj6' class='acc-margin'>
                <div class='panel-group' id='accordionobjective6Url'>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    /*********** Back On Top Page Script **********/
    $j(window).scroll(function() {
    if ($j(this).scrollTop() >= 50) {    // If page is scrolled more than 50px
        $j('#back-on-top').fadeIn(200);  // Fade in the arrow
    } else {
        $j('#back-on-top').fadeOut(200); // Else fade out the arrow
    }
    });
    $j('#back-on-top').click(function() { // When arrow is clicked
        $j('body,html').animate({
            scrollTop : 0                // Scroll to top of body
        }, 500);
    });
</script>
<div id="toTheTop" class="disableToTheTop">
    <a href="#" id="back-on-top"><i class="icon-chevron-up"></i></a>
</div>